<!DOCTYPE html>

<!-- 基準URI -->
<base href="https://takaha-q.github.io/">

<!-- スタイルシート -->
<link rel="stylesheet" href="Sytle001.css" type="text/css">

<!-- スクリプト -->
<!-- タイトル表示 -->
<script src="MakeTitle.js" type="text/javascript"></script>

<!-- 目次表示 -->
<script src="MakeToc_L.js" type="text/javascript"></script>

<!-- ページタイトル(ページ内表示) -->
<span id="title"></span>

<!-- リンク(ホームに戻る) -->
<a href="index.html">ホームに戻る</a><br>

<!-- 出典ページ -->
<h5>出典 :</h5>
<a href="https://learn.microsoft.com/ja-jp/dotnet/api/system.windows.controls.tabcontrol?view=windowsdesktop-8.0">TabControl クラス (System.Windows.Controls) | Microsoft Learn</a><br>
<a href="https://blog.okazuki.jp/entry/2014/08/15/232445">WPF4.5入門 その37 「TabControl」 - かずきのBlog@hatena</a><br>
<a href="https://qiita.com/e-Bags/items/87e4f01464cb993ab026">[WPF, XAML] TabControl でWebっぽいメニューをつくる #C# - Qiita</a><br>
<a href="https://qiita.com/WPF_Tarou/items/65285a0c945ed4b485aa">[C#/WPF]動的にタブを生成するタブコントロール #C# - Qiita</a><br>
<a href="https://learn.microsoft.com/ja-jp/dotnet/api/system.windows.controls.primitives.selector?view=windowsdesktop-8.0">Selector クラス (System.Windows.Controls.Primitives) | Microsoft Learn</a>
<a href="https://learn.microsoft.com/ja-jp/dotnet/api/system.windows.controls.itemscontrol?view=windowsdesktop-8.0"></a>

<!-- 関連ページ -->
<h5>関連 :</h5>
<a href="TIPS/Windows Presentation Foundation(WPF)/[パネル]Grid.html">Grid</a><br>
<a href="TIPS/Windows Presentation Foundation(WPF)/[パネル]DockPanelとStackPanel.html">DockPanelとStackPanel</a><br>
<a href="TIPS/Windows Presentation Foundation(WPF)/[外観]テンプレート.html">テンプレート</a><br>
<a href="TIPS/Windows Presentation Foundation(WPF)/[データバインディング]データバインディング.html">データバインディング</a><br>
<a href="TIPS/dotNET・C Sharp/LINQ (Language Integrated Query).html">[C#]LINQ (Language Integrated Query)</a>

<!-- 目次 -->
<h5>目次 :</h5>
<div id="toc"></div>
<hr>

<!-- 本文ここから -->
<h2>TabControl とは</h2>
画面上の同じスペースに複数の内容を表示するためのコントロール。<br>
タブを選択することで表示する内容を切り替えられる。<br>

<h2>基本的な例</h2>

以下は TabControl に3つのタブを作成する場合の例である。<br>
図では「TabItem1」の内容が表示されているが、タブ「TabItem2」、「TabItem3」をクリックすると、それぞれのタブの内容が表示される。<br>
各タブの内容は TabItem として定義し、TabItem の Header プロパティにタブの表題を指定する。

<h5>XAML</h5>
<div class="xaml">
&lt;TabControl&gt;
    &lt;TabItem Header="TabItem1"&gt;
        &lt;TextBlock Text="TabItem1 Content" /&gt;
    &lt;/TabItem&gt;
    &lt;TabItem Header="TabItem2"&gt;
        &lt;TextBlock Text="TabItem2 Content" /&gt;
    &lt;/TabItem&gt;
    &lt;TabItem Header="TabItem3"&gt;
        &lt;TextBlock Text="TabItem3 Content" /&gt;
    &lt;/TabItem&gt;
&lt;/TabControl&gt;
</div>

<h5>画面表示</h5>
<img src="https://raw.githubusercontent.com/Takaha-Q/Takaha-Q.github.io/main/_Img/WPF/TabControl/01.png" alt="画像"><br>

<h2>コレクションの表示</h2>
TabControl クラスは Selector を継承しているため、 ItemsSource プロパティにコレクションを設定することでコレクションの要素を各タブに関連付けられる。<br>
これは ListBox や ComboBox と同様である。

<h5>Model(CS)</h5>
<div class="cs">
// コレクションの要素として用いる Person クラス
public class Person
{
    public string Name { get; set; }
    public int Age { get; set; }
}
</div>

<h5>View(MainWindow.cs.xaml)</h5>
<div class="xaml">
&lt;!-- TabControl : "tabControl" --&gt;
&lt;TabControl x:Name="tabControl"&gt;
    &lt;!-- ItemTemplate : タブの表題( Header )に関連 --&gt;
    &lt;TabControl.ItemTemplate&gt;
        &lt;DataTemplate&gt;
            &lt;!-- タブ表題を TextBlock として表示 --&gt;
            &lt;!-- TextBlock.Text を Person.Name にバインド --&gt;
            &lt;TextBlock Text="{Binding Name}" /&gt;
        &lt;/DataTemplate&gt;
    &lt;/TabControl.ItemTemplate&gt;

    &lt;!-- ContentTemplate : タブの内容( Content )に関連 --&gt;
    &lt;TabControl.ContentTemplate&gt;
        &lt;DataTemplate&gt;
            &lt;Grid&gt;
                &lt;Grid.RowDefinitions&gt;
                    &lt;RowDefinition Height="Auto" /&gt;
                    &lt;RowDefinition Height="Auto" /&gt;
                &lt;/Grid.RowDefinitions&gt;
                &lt;Grid.ColumnDefinitions&gt;
                    &lt;ColumnDefinition Width="Auto" /&gt;
                    &lt;ColumnDefinition/&gt;
                &lt;/Grid.ColumnDefinitions&gt;

                &lt;Label      Grid.Row="0" Grid.Column="0" Content="名前" /&gt;

                &lt;!-- TextBlock.Text を Person.Name にバインド --&gt;
                &lt;TextBlock  Grid.Row="0" Grid.Column="1" Text="{Binding Name}" /&gt;

                &lt;Label      Grid.Row="1" Grid.Column="0" Content="年齢" /&gt;

                &lt;!-- TextBlock.Text を Person.Age にバインド --&gt;
                &lt;TextBlock  Grid.Row="1" Grid.Column="1" Text="{Binding Age}" /&gt;

            &lt;/Grid&gt;
        &lt;/DataTemplate&gt;
    &lt;/TabControl.ContentTemplate&gt;

&lt;/TabControl&gt;
</div>

<h5>ViewModel(MainWindow.cs)</h5>
<div class="cs">
public MainWindow()
{
    InitializeComponent();

    // コレクション source の初期化
    var source = Enumerable.Range(1, 10)
        .Select(i => new Person { Name = "おおた" + i, Age = 20 + i });

    // tabControl の ItemsSource にコレクション source を指定
    this.tabControl.ItemsSource = source;
}
</div>

<h5>画面表示</h5>
<img src="https://raw.githubusercontent.com/Takaha-Q/Takaha-Q.github.io/main/_Img/WPF/TabControl/02.png" alt="画像">

<h5>解説</h5>
上記はコレクションを TabControl に関連付ける例である。<br>
ここでは<a href="TIPS/Windows Presentation Foundation(WPF)/[外観]テンプレート.html">テンプレート</a>を使用し、ItemTemplate でタブの表題( Header )、ContentTemplate でタブの内容( Content )を指定する。<br>
Person 型のコレクション source を TabControl の ItemsSource プロパティに代入すると、TabControl では source の要素ごとにタブを割り当てる。<br>
( source の初期化時に<a href="TIPS/dotNET・C Sharp/LINQ (Language Integrated Query).html">LINQ( Select() )</a>を使用している点に注意。)<br>
TabControl.ItemsSource が割り当てられているため、XAML側では<a href="TIPS/Windows Presentation Foundation(WPF)/[データバインディング]データバインディング.html">データバインディング</a>により値を参照できる。<br>
