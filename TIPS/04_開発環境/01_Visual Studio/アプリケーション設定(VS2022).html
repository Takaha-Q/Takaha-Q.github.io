<!DOCTYPE html>

<!-- 基準URI -->
<base href="https://takaha-q.github.io/">

<!-- スタイルシート -->
<link rel="stylesheet" href="Sytle001.css" type="text/css">

<!-- スクリプト -->
<!-- タイトル表示 -->
<script src="MakeTitle.js" type="text/javascript"></script>

<!-- 目次表示 -->
<script src="MakeToc_L.js" type="text/javascript"></script>

<!-- ページタイトル(ページ内表示) -->
<span id="title"></span>

<!-- リンク(ホームに戻る) -->
<a href="index.html">ホームに戻る</a>

<!-- 出典ページ -->
<details><summary class=link>出典 :</summary>
<div class=pre><a href="https://learn.microsoft.com/ja-jp/visualstudio/ide/reference/settings-page-project-designer?view=vs-2022&f1url=%3FappId%3DDev16IDEF1%26l%3DJA-JP%26k%3Dk(ApplicationSettingsOverview)%26rd%3Dtrue">[設定] ページ (プロジェクト デザイナー) - Visual Studio (Windows) | Microsoft Learn</a>
</div></details>

<!-- 目次 -->
<h5>目次 :</h5>
<div id="toc"></div>
<hr>

<!-- 本文ここから -->

<h2>アプリケーション設定</h2>
<div class=pre>アプリケーションで、特定の値を次回起動時に再度使用したい場合はアプリケーション設定に保存する。
例) 前回開いていたフォルダパスを保存し、同じパスを再度開く
以下、Visual Studio 2022における、アプリケーション設定の使用手順を解説する。
(VS2022ではアプリケーション設定の取り扱いが変更されているため、旧バージョンでは手順が異なる。)
</div>

<h2>設定の追加</h2>
<ol>
    <li>プロジェクトファイルを右クリック、「プロパティ」を選択する。<br>
    <img src="https://raw.githubusercontent.com/Takaha-Q/Takaha-Q.github.io/main/_Img/MSVS/AppSettings/01.png" alt="画像"></li>
    <li>ダイアログが開くので、「設定」>「全般」を選択し、「アプリケーション設定を作成する/開く」をクリックする。<br>
    <img src="https://raw.githubusercontent.com/Takaha-Q/Takaha-Q.github.io/main/_Img/MSVS/AppSettings/02.png" alt="画像"></li>
    <li>Properties フォルダと、Settings.setting 、Setting.Designer.cs 、App.config の各ファイルが追加される。<br>
    <img src="https://raw.githubusercontent.com/Takaha-Q/Takaha-Q.github.io/main/_Img/MSVS/AppSettings/04.png" alt="画像"><br>
    設定グリッドが開くので、保存したい項目(ここでは RecentFolder )を追加し、各項目を入力する。<br>
    項目は新たに作成された Settings クラスのプロパティ(正確にはインデクサー)となる。<br>
    (「スコープ」、「アクセス修飾子」は通常は変更不要。)<br>
    <img src="https://raw.githubusercontent.com/Takaha-Q/Takaha-Q.github.io/main/_Img/MSVS/AppSettings/03.png" alt="画像"></li>
</ol>

<h2>設定へのアクセスと保存</h2>
<div class=pre>設定項目は通常、[アプリケーション名].Properties 名前空間の Settings クラスのプロパティとして追加される。
(実際の名前空間は Settings.Designer.cs より確認すること。)
追加された RecentFolder プロパティにアクセスするには、
<code><knw>Properties</knw>.<knw>Settings</knw>.Default.RecentFolder</code>と記述する。

設定の読み込みは起動時に自動的に行われるが、設定の保存はVisual Basicを除いて明示的に行う必要があり、
<code><knw>Properties</knw>.<knw>Settings</knw>.Default.Save();</code>と記述する。

設定は
<code>C:\Users\[ユーザ名]\AppData\Local\[アプリケーション固有のフォルダ]</code>に config ファイルとして保存される。
<img src="https://raw.githubusercontent.com/Takaha-Q/Takaha-Q.github.io/main/_Img/MSVS/AppSettings/05.png" alt="画像">
初回起動時や config ファイルを削除した場合など、config ファイルが存在しない場合は新規に作成される。
</div>

<h2>設定項目の編集</h2>
Settings.setting を開くと編集が可能。上記「設定の追加」節を参照。

